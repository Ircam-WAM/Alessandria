{% extends 'alexandrie/base_tpl.html' %}

{% block title %}Lecteur{% endblock %}

{% block pageTitle %}Lecteur{% endblock %}

{% block content %}

<div class="row">
    <div class="col-sm-6">
        {% include 'alexandrie/inc_form_header.html' %}
        {% if form.instance.is_disabled %}
            <div class="textInfo">Ce lecteur a été désactivé le {{form.instance.disabled_on }}.</div>
        {% endif %}        
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h3 class="panel-title">{{object.get_full_name|default:"Nouveau lecteur"}}</h3>
            </div>
            <div class="panel-body">
                <form class="form-horizontal" action="" method="post" role="form">{% csrf_token %}
                    {% include 'alexandrie/inc_form_content_std.html' %}
                    <button type="submit" class="btn btn-primary">Enregistrer</button>
                    {% if form.instance.id > 0 %}
                        {% if not form.instance.is_disabled %}
                            <a class="btn btn-warning" href="{% url 'alexandrie:reader_disable' form.instance.id %}">Désactiver</a>
                        {% endif %}
                    {% endif %}
                </form>
                {% include 'alexandrie/inc_form_footer.html' %}
            </div>
        </div>
    </div><!-- /.col-sm-6 -->
    <div class="col-sm-6">
    {% if object.id > 0 %}
        <div class="panel panel-info">
            <div class="panel-heading">
                <h3 class="panel-title">Emprunts</h3>
            </div>
            <div class="panel-body">

                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">Résumé</h3>
                    </div>
                    <div class="panel-body">
                        <dl class="dl-horizontal">
                            <dt>Nb d'emprunts:</dt><dd>{{ object.nb_borrow }}</dd>
                        </dl>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">Emprunts en cours</h3>
                    </div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Date emprunt</th>
                                <th>Livre</th>
                                <th>Retour pour le</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for borrow in object.list_borrow_current %}
                            {% if borrow.is_late %}
                                <tr class="bg-warning">
                            {% else %}
                                <tr>
                            {% endif %}
                                    <td><a href="{% url 'alexandrie:reader_borrow_update' borrow.id %}">{{ borrow.borrowed_date }}</a></td>
                                    <td>{{ borrow.bookcopy.book }}</td>
                                    <td>{{ borrow.borrow_due_date }}</td>
                                </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    {% endif %}
    </div>
</div>
{% endblock %}
